


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	<META NAME="Keywords" CONTENT="">
	<meta http-equiv="X-UA-Compatible" content="IE=8"/>
	<!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no" />
	
	<link rel="stylesheet" href="css/reset.css">
	<!--<link rel="stylesheet" href="css/bootstrap.css">-->
	<link rel="stylesheet" href="css/ui-lightness/jquery-ui-1.10.2.custom.min.css">
	<link rel="stylesheet" href="css/estilo.css">
	
		<link rel="stylesheet" href="css/estiloes.css">
	
	<link href="css/estilos_impresion.css" rel="stylesheet" type="text/css" media="print"> 
	
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.8.0.js"></script> 
	<script type="text/javascript" src="scripts/scripts.js"></script> 
	<script type="text/javascript" language="javascript" src="lytebox.js"></script>
	<script type="text/javascript" src="scripts/scripts-horarisMenuEsq.js"></script> 
	<script type="text/javascript" src="scripts/iCastella.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script>
	<script type="text/javascript" src="scripts/jquery.elevateZoom-2.5.5.min.js"></script>
	
	
	
 	<script type="text/javascript" src="scripts/jquery.flip.min.js"></script> 
 	
 	
 	
 	<!-- <script type="text/javascript" src="https://maps.google.com/maps/api/js?libraries=geometry&sensor=false"></script>	
	<link href="https://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" /> -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>
		
	<link rel="stylesheet" href="lytebox.css" type="text/css" media="screen">
	<link rel="stylesheet" href="css/jquery.selectboxit.css" type="text/css">
  <title>Transports Municipals Rubi</title>
	<script type="text/javascript">
		
		$(document).ready(function() {
		  //$("select").selectBoxIt();
			$(".muestraTitle").tooltip({
	      track: true
	    });
  	});
		
		function lanza(){
				var objLink = document.getElementById('msie7');
        myLytebox.start(objLink, false, true); 
     
		}
	</script>	
	<!--[if lte IE 5]>
	<script type="text/javascript">
	  setTimeout("lanza()",4000);
	</script>
	<![endif]-->
	<!--[if lte IE 6]>
	<script type="text/javascript">
	  setTimeout("lanza()",4000);
	</script>
	<![endif]-->
	<!--[if lte IE 7]>
	<script type="text/javascript">
	  setTimeout("lanza()",4000);
	</script>
	<![endif]-->


<link href="CSS/responsive.min.css" rel="stylesheet" type="text/css"/>
<script src="SCRIPTS/responsive.min.js" type="text/javascript"></script>

	
</head>
<body >
<div id="page">
	
<div id="RedesSociales">
	<a href="https://www.facebook.com/pages/Rubibus/569623996411235" id="facebook"  title="Ir a facebook" target="new" class="muestraTitle"><div class="linkSocial"></div></a>
	<!--<a href="https://twitter.com/Rubibus1" id="twitter"  title="Ir a twitter" target="new" class="muestraTitle"><div class="linkSocial"></div></a>-->
	<a href="https://rubibus.com/index.asp?seccion=textosReducido&subsec=15&lang=es" id="linkcontacto"  title="Ir a contacto" class="muestraTitle"><div class="linkSocial"></div></a>
	<a href="https://rubibus.com/index.asp?lang=es" id="linkhome"  title="Ir a home" class="muestraTitle"><div class="linkSocial"></div></a>
</div>

	
	<div class="Izquierda">
		<div id="Presentacion">
			<!--Cargamos modulos comunes -->
			
	<a href="https://rubibus.com/index.asp?lang=es"  title="Ir a home"  class="muestraTitle" >
	<div id="Logo">
	</div>
	</a>
		<div id="Idiomas">
			<a href="https://rubibus.com/index.asp?lang=ca" title="">Català</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="https://rubibus.com/index.asp?lang=es" title="">Castellano</a>
		</div>
		<div id="Galeria">
			<div id="slideshow">
			    <img src="DOCUMENTS/banner/banner_benvinguts_01_e.png" alt="" class="active" />
			    <img src="DOCUMENTS/banner/banner_benvinguts_02_e.png" alt="" />
			    <img src="DOCUMENTS/banner/banner_benvinguts_03_e.png" alt="" />
			</div>
		</div>
		<script type="text/javascript">

			/***
			    Simple jQuery Slideshow Script
			    Released by Jon Raasch (jonraasch.com) under FreeBSD license: free to use or modify, not responsible for anything, etc.  Please link out to me if you like it :)
			***/

			function slideSwitch() {
			    var $active = $('#slideshow IMG.active');

			    if ( $active.length == 0 ) $active = $('#slideshow IMG:last');

			    // use this to pull the images in the order they appear in the markup
			    var $next =  $active.next().length ? $active.next()
			        : $('#slideshow IMG:first');

			    // uncomment the 3 lines below to pull the images in random order

			    // var $sibs  = $active.siblings();
			    // var rndNum = Math.floor(Math.random() * $sibs.length );
			    // var $next  = $( $sibs[ rndNum ] );


			    $active.addClass('last-active');

			    $next.css({opacity: 0.0})
			        .addClass('active')
			        .animate({opacity: 1.0}, 1000, function() {
			            $active.removeClass('active last-active');
			        });
			}

			$(function() {
			    setInterval( "slideSwitch()", 2500 );
			});

		</script>

	<div id="ModuloTarifas" >
		<a href="https://rubibus.com/index.asp?seccion=tarifaRubi&lang=es" title="Ir a tarifas RubíBus"  class="muestraTitle" >
			<div id="tarifaRubiBus" class="tarifas">
				<span class="normal negrita">Tarifas</span>
				<div class="alineacionbajo">
					Billetes&nbsp;<span class="negrita">RubíBus</span>
				</div>
			</div>
		</a>
		<a href="https://rubibus.com/index.asp?seccion=tarifesATM1&lang=es" title="Ir a tarifas ATM"  class="muestraTitle" >
			<div id="tarifaATM" class="tarifas">
				<span class="normal negrita">Tarifas</span>
				<div class="alineacionbajo">
					Billetes&nbsp;<span class="negrita">ATM</span>
				</div>
			</div>
		</a>
	</div>
	<div class="clear"></div>


	<a href="https://rubibus.com/index.asp?seccion=puntosVenta&lang=es" title="Ir a Puntos de venta" class="muestraTitle" >
	<div id="ModuloGoogleMaps">

	</div>
	</a>

<div id="ModuloTiempoMaps">
	<div id="tiempoEnRubi">
		<!-- www.TuTiempo.net - Ancho:136px - Alto:46px -->
		<div id="TT_vxegbBYhttt9QIrK7AqDzzzDz6lKTKtkE1kk1E1E1kE"><a href="https://www.tutiempo.net">El Tiempo</a><a href="https://www.tutiempo.net/Tiempo-Rubi-E08549.html">El tiempo en Rubï¿½</a></div>
		<script type="text/javascript" src="https://www.tutiempo.net/widget/eltiempo_vxegbBYhttt9QIrK7AqDzzzDz6lKTKtkE1kk1E1E1kE"></script>
		<div class="alineacionbajo">
		<span class="negrita">Jueves</span><bR>
		25&nbsp;de&nbsp;Marzo
	</div>
</div>
<a href="https://rubibus.com/index.asp?seccion=videos&lang=es" title="Anar a videos tutorial"  class="muestraTitle" >
<div id="videoTutorial">

</div>
</a>
</div>
<div class="clear"></div>

		</div>
	</div>
	
	<div class="Main">
		
	<div id="InfoTop">
		<a href="https://rubibus.com/index.asp?seccion=planoGeneral&lang=es" title="Ir a Plano General" class="muestraTitle">
		<div id="MenuPlanoGeneral" class='normal'>

		</div>
		</a>
		<a href="https://rubibus.com/index.asp?seccion=horarioGeneral&lang=es" title="Ir a Horarios" class="muestraTitle">
		<div id="MenuHorarios" class='normal'>

		</div>
		</a>
		<a rel="lyteframe" href="avisohome.asp?lang=es"  data-title="Ir a Avisos" class="lytebox muestraTitle">
		<div id="MenuAvisos">

		</div>
		</a>

		<div id="MenuLineasPequeno">
			
    			<a href="https://rubibus.com/index.asp?seccion=planolinia&lang=es&linia=1" title="Ir a Línea 1" class="muestraTitle">
    				<img width="35px" src="https://rubibus.com/DOCUMENTS/Menu/Linies/l1ro.png"  onmouseover="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l1no.png';" onmouseout="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l1ro.png';" />
    			</a>
    			
    			<a href="https://rubibus.com/index.asp?seccion=planolinia&lang=es&linia=2" title="Ir a Línea 2" class="muestraTitle">
    				<img width="35px" src="https://rubibus.com/DOCUMENTS/Menu/Linies/l2ro.png"  onmouseover="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l2no.png';" onmouseout="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l2ro.png';" />
    			</a>
    			
    			<a href="https://rubibus.com/index.asp?seccion=planolinia&lang=es&linia=3" title="Ir a Línea 3" class="muestraTitle">
    				<img width="35px" src="https://rubibus.com/DOCUMENTS/Menu/Linies/l3ro.png"  onmouseover="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l3no.png';" onmouseout="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l3ro.png';" />
    			</a>
    			
    			<a href="https://rubibus.com/index.asp?seccion=planolinia&lang=es&linia=4" title="Ir a Línea 4" class="muestraTitle">
    				<img width="35px" src="https://rubibus.com/DOCUMENTS/Menu/Linies/l4ro.png"  onmouseover="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l4no.png';" onmouseout="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l4ro.png';" />
    			</a>
    			
    			<a href="https://rubibus.com/index.asp?seccion=planolinia&lang=es&linia=5" title="Ir a Línea 5" class="muestraTitle">
    				<img width="35px" src="https://rubibus.com/DOCUMENTS/Menu/Linies/l5ro.png"  onmouseover="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l5no.png';" onmouseout="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l5ro.png';" />
    			</a>
    			
    			<a href="https://rubibus.com/index.asp?seccion=planolinia&lang=es&linia=6" title="Ir a Línea 6" class="muestraTitle">
    				<img width="35px" src="https://rubibus.com/DOCUMENTS/Menu/Linies/l6ro.png"  onmouseover="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l6no.png';" onmouseout="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l6ro.png';" />
    			</a>
    			
    			<a href="https://rubibus.com/index.asp?seccion=planolinia&lang=es&linia=7" title="Ir a Línea 7" class="muestraTitle">
    				<img width="35px" src="https://rubibus.com/DOCUMENTS/Menu/Linies/l7ro.png"  onmouseover="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l7no.png';" onmouseout="this.src='https://rubibus.com/DOCUMENTS/Menu/Linies/l7ro.png';" />
    			</a>
    			
			<div class="clear"></div>

		</div>
		<div class="clear"></div>
	</div>

					<div id="ModuloCentral">
						
	<script type="text/javascript" src="scripts/scripts-horaris.js"></script> 
	
	<script language="javascript">
		$(document).ready(function() {
			$(".botoHoraris").click(function() {
				window.location=$(this).find("a").attr("href");
				return false;
			});
		});
		
		function updateLinea() {
			var val;
			val = document.getElementById("IdLinea").value;
			//prompt("",'consultes.asp?proces=PassaLinea&idLinea='+val);
			if( val > 0 ){
				$.ajax({
					url:	'consultes.asp?nocache=' + Math.random(),
					type: 'POST',
					data: 'proces=PassaLineaBarraMenu&idLinea='+val,
					dataType: 'text',
					success: function(respuesta) {
						//alert(respuesta);
						var StrJornadas = respuesta.split("<");
						document.getElementById("IdSentido").innerHTML = "";
						document.getElementById("IdJornada").innerHTML = "";
						$('#IdSentido').append('<option value="0" title="Escoge una jornada" selected> Escoge una jornada</option>');
						$('#IdJornada').append('<option value="0" title="Escoge una jornada" selected> Escoge una jornada</option>');
						for(i=0;i<StrJornadas.length;i++){
							if(StrJornadas[i] != ""){
								tupla=StrJornadas[i].split(">");
								id=tupla[0];
								nombre=tupla[1];
								nombre = nombre.replace("-"," > ");
								if(respuesta != ""){
									$('#IdJornada').append('<option value="'+id+'" title="'+nombre+'"> '+nombre+'</option>');
								}
							}
						}
						document.getElementById("IdParadaOr").innerHTML = "";
						document.getElementById("IdParadaDe").innerHTML = "";
						$('#IdParadaOr').append('<option value="0" title="Escoge una jornada" selected> Escoge una jornada</option>');
						$('#IdParadaDe').append('<option value="0" title="Escoge una jornada" selected> Escoge una jornada</option>');
					},
					error: function() {
						
					}
				});
			}
			else{
				document.getElementById("idJornada").innerHTML = "";
				document.getElementById("IdSentido").innerHTML = "";
				document.getElementById("IdParadaOr").innerHTML = "";
				document.getElementById("IdParadaDe").innerHTML = "";
				$('#IdJornada').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
				$('#IdSentido').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
				$('#IdParadaOr').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
				$('#IdParadaDe').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
			}
		}
		
		function updateJornada() {
			var val, val2;
			val = document.getElementById("IdLinea").value;
			val2 = document.getElementById("IdJornada").value;
			//prompt("",'consultes.asp?proces=PassaJornada&idLinea='+val+'&idJornada='+val2);
			if( val > 0 ){
				$.ajax({
					url:	'consultes.asp?nocache=' + Math.random(),
					type: 'POST',
					data: 'proces=PassaJornada&idLinea='+val+'&idJornada='+val2,
					dataType: 'text',
					success: function(respuesta) {
						//alert(respuesta);
						var StrSentidos = respuesta.split("<");
						document.getElementById("IdSentido").innerHTML = "";
						$('#IdSentido').append('<option value="0" title="" selected> </option>');
						for(i=0;i<StrSentidos.length;i++){
							if(StrSentidos[i] != ""){
								tupla=StrSentidos[i].split(">");
								id=tupla[0];
								nombre=tupla[1];
								nombre = nombre.replace("-"," > ");
								if(respuesta != ""){
									$('#IdSentido').append('<option value="'+id+'" title="'+nombre+'"> '+nombre+'</option>');
								}
							}
						}
						document.getElementById("IdParadaOr").innerHTML = "";
						document.getElementById("IdParadaDe").innerHTML = "";
						$('#IdParadaOr').append('<option value="0" title="" selected> </option>');
						$('#IdParadaDe').append('<option value="0" title="" selected> </option>');
					},
					error: function() {
						
					}
				});
			}
			else{
				document.getElementById("IdSentido").innerHTML = "";
				document.getElementById("IdParadaOr").innerHTML = "";
				document.getElementById("IdParadaDe").innerHTML = "";
				$('#IdSentido').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
				$('#IdParadaOr').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
				$('#IdParadaDe').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
			}
		}
		
		function updateSentido() {
			var val, val2;
			val = document.getElementById("IdJornada").value;
			val2 = document.getElementById("IdSentido").value;
			if( val2 > 0 ){
				//prompt("",'consultes.asp?proces=PassaSentit&idSentit='+val2+'&idJornada='+val);
				$.ajax({
					url:	'consultes.asp?nocache=' + Math.random(),
					type: 'POST',
					data: 'proces=PassaSentit&idSentit='+val2+'&idJornada='+val,
					dataType: 'text',
					success: function(respuesta) {
						//alert(respuesta);
						var StrSentidos = respuesta.split("<");
						document.getElementById("IdParadaOr").innerHTML = "";
						document.getElementById("IdParadaDe").innerHTML = "";
						$('#IdParadaOr').append('<option value="0" title="" selected> </option>');
						$('#IdParadaDe').append('<option value="0" title="" selected> </option>');
						for(i=0;i<StrSentidos.length;i++){
							if(StrSentidos[i] != ""){
								tupla=StrSentidos[i].split(">");
								id=tupla[0];
								nombre=tupla[1];
								if(nombre != null)
									nombre = nombre.replace("-"," > ");
								if(respuesta != ""){
									$('#IdParadaOr').append('<option value="'+id+"-"+nombre+'" title="'+nombre+'"> '+nombre+'</option>');
									$('#IdParadaDe').append('<option value="'+id+"-"+nombre+'" title="'+nombre+'"> '+nombre+'</option>');
								}
							}
						}
					},
					error: function() {
						
					}
				});
			}
			else{
				document.getElementById("IdParadaOr").innerHTML = "";
				$('#IdParadaOr').append('<option value="0" title="Escoge una linia" selected> Escoge una linia</option>');
			}
		}
		
		function calcularHora(v1,v2)
		{
	    horas1=v1.split(":"); /*Mediante la función split separamos el string por ":" y lo convertimos en array. */
	    horas2=v2.split(":");
	    horatotale=new Array();
	    for(a=0;a<3;a++) /*bucle para tratar la hora, los minutos y los segundos*/
	    {
//        horas1[a]=(isNaN(parseInt(horas1[a])))?0:parseInt(horas1[a]) /*si horas1[a] es NaN lo convertimos a 0, sino convertimos el valor en entero*/
//        horas2[a]=(isNaN(parseInt(horas2[a])))?0:parseInt(horas2[a])
        horatotale[a]=(horas1[a]-horas2[a]);/* insertamos la resta dentro del array horatotale[a].*/
	    }
	    horatotal=new Date()  /*Instanciamos horatotal con la clase Date de javascript para manipular las horas*/
	    horatotal.setHours(horatotale[0]); /* En horatotal insertamos las horas, minutos y segundos calculados en el bucle*/
	    horatotal.setMinutes(horatotale[1]);
	    horatotal.setSeconds(horatotale[2]);
	    var horatotalfinal  = "";
	    if( horatotal.getHours() > 0 )
	    	horatotalfinal = horatotal.getHours()+"h. "
	    horatotalfinal = horatotalfinal + horatotal.getMinutes()+"' "
	    if(horatotal.getHours() > 3)
				horatotalfinal = "No disponible"
	    return horatotalfinal; /*Devolvemos el valor calculado en el formato hh:mm:ss*/
	    //+horatotal.getSeconds()
		}
		
		function calcula(){
			$('#ErrortaulaTemps').css( 'display','none' );
			campOrigen = document.getElementById("IdParadaOr").value;
			campOrigen = campOrigen.split("-");
			
			val = campOrigen[0];
			val = val.replace(/ /g,"-|-");
			campDesti = document.getElementById("IdParadaDe").value;
			campDesti = campDesti.split("-"); 
			val2 = campDesti[0];
			val2 = val2.replace(/ /g,"-|-");
			valo = document.getElementById("IdLinea").value;
			valores=valo.split("-");
			var vIdLinia=valores[0];
			val3 = valores[1];
			//prompt("",'consultes.asp?proces=DemanaIdParades&NomParadaOr='+val+'&NomParadaDe='+val2+'&idSentido='+val3);
			$.ajax({
				url:	'consultes.asp?nocache=' + Math.random(),
				type: 'POST',
				data: 'proces=DemanaIdParades&NomParadaOr='+val+'&NomParadaDe='+val2+'&idSentido='+val3,
				dataType: 'text',
				success: function(respuesta) {
					var idParadesRebudes = respuesta.split(">");
					val = idParadesRebudes[0];
					val2 = idParadesRebudes[1];
					//alert("val:"+val);
					//alert("val2:"+val2);
					if( parseInt(val) > 0 && parseInt(val2) > 0 && respuesta != "-1"){
						document.getElementById("taulaTemps").innerHTML = "";
						$('#taulaTemps').append('<table id="taulaTempsTable" width="515px" border="0" cellspacing="0" cellpadding="0"><tr><td class="taulaHoraCalCap centrat" width="171px">Parada origen</td><td class="taulaHoraCalCap centrat" width="171px">Parada destino</td><td class="taulaHoraCalCap centrat" width="171px">Tiempo del recorrido</td></tr><tr><td class="taulaHoraCalSubCap centrat" id="txtPOr"></td><td class="taulaHoraCalSubCap centrat" id="txtPDe"></td><td class="taulaHoraCalSubCap">&nbsp;</td></tr></table>');
						POr=$('#IdParadaOr').val();
						POr=POr.split("-");
						$("#IdParadaOr option").each(function(){
				    		if($(this).attr('value')==POr){
				       		campOrg=$(this).text();
				      	}
				    });
						PDe=$('#IdParadaDe').val();
						PDe=PDe.split("-");				
						$("#IdParadaDe option").each(function(){
				    		if($(this).attr('value')==PDe){
				       		campDest=$(this).text();
				      	}
				    });
						$('#txtPOr').append(campOrg);
						$('#txtPDe').append(campDest);
						dia = $('#IdJornada').val();
						//prompt("",'consultes.asp?proces=DemanaHora&idParadaOr='+POr[0]+'&idParadaDe='+PDe[0]+'&idSentido='+val3+'&idJornada='+dia);
						$.ajax({
							url:	'consultes.asp?nocache=' + Math.random(),
							type: 'POST',
							data: 'proces=DemanaHora&idParadaOr='+val+'&idParadaDe='+val2+'&idSentido='+val3+'&idJornada='+dia,
							dataType: 'text',
							success: function(respuesta) {
								var Horarios = respuesta.split("<");
								
								if (Horarios[0]!="" && Horarios[1]!=""){
									
									var Horario1 = Horarios[0].split(">");
									var Horario2 = Horarios[1].split(">");
								
									var MaxPetit = 99999;
									var fons = 0;
									if (MaxPetit > Horario1.length && Horario1.length > 1)
										MaxPetit = Horario1.length;
									if (MaxPetit > Horario2.length && Horario2.length > 1)
										MaxPetit = Horario2.length;
									//alert('Tamany MaxPetit: '+MaxPetit+', Horario1: '+Horario1+', Horario2: '+Horario2);
									for(i=0;i<MaxPetit-parseInt(1);i++){
										if(Horario1[i+parseInt(1)] != 'no' && Horario2[i+parseInt(1)] != 'no' && i % 2 == 0) {
											var resta = calcularHora(Horario2[i], Horario1[i]);
											clase = "taulaHoraCalContent2";
											if( fons % 2 == 0 )
												clase = "taulaHoraCalContent1";
											horas1=Horario1[i].split(":"); /*Mediante la función split separamos el string por ":" y lo convertimos en array. */
									    horas2=Horario2[i].split(":");
									    horatotale=new Array();
									    horatotal1=new Date()  /*Instanciamos horatotal con la clase Date de javascript para manipular las horas*/
									    horatotal2=new Date()
									    horatotal1.setHours(horas1[0]);
									    horatotal1.setMinutes(horas1[1]);
									    horatotal2.setHours(horas2[0]);
									    horatotal2.setMinutes(horas2[1]);
									    var hora1 = horatotal1.getHours()+":";
									    if(horatotal1.getMinutes()<10)
									    	hora1 = hora1 + '0' + horatotal1.getMinutes();
									    else
									    	hora1 = hora1 + horatotal1.getMinutes();
									    if(horatotal1.getHours()<10)
									    	hora1 = hora1 + "&nbsp;";
									    var hora2 = horatotal2.getHours()+":";
									    if(horatotal2.getMinutes()<10)
									    	hora2 = hora2 + '0' + horatotal2.getMinutes();
									    else
									    	hora2 = hora2 + horatotal2.getMinutes();
									    if(horatotal2.getHours()<10)
									    	hora2 = hora2 + "&nbsp;";
									   $('#taulaTempsTable').append('<tr class="'+clase+'"><td class="centrat">'+hora1+'</td><td class="centrat">'+hora2+'</td><td class="centrat">'+resta+'</td></tr>');
											fons = fons + parseInt(1);
										}
									}
									$('#taulaTemps').css( 'display','block' );
								}else{
									$('#ErrortaulaTemps').css( 'display','block' );
								}
							},
							error: function() {
								alert("error");
							}
						});
					}
					else{
						if( respuesta == "-1" ){
							alert("");
						}
						else{
							if( val <= 0 && val2 <= 0 )
								alert("");
							else if( val <= 0 )
								alert("");
							else if( val2 <= 0 )
								alert("");
						}
					}
				},
				error: function() {
					alert("error");
				}
			});
		}
	</script>
	
	<div id="CalculoTiempoRecorrido">
		<div id="CalculoTextos">
			<div class="izquierda">
				<h1>Calcular el tiempo  que tardará el bus   en hacer un recorrido   entero</h1> 
				<br>
				<p style="line-height: 16px;">
					Para calcular el tiempo del recorrido del Bus hace falta seleccionar en los menús de la derecha el número de la Línea, la parada de orígen y destino y especificar la jornada. La tabla con los tiempos aparecerá en la parte inferior de esta página.
				</p>
			</div>
			<div class="derecha">
				<div class="div-table">
					<div class="div-table-row">
						<div class="div-table-col">Línea</div>
						<div class="div-table-col">
							<select name="IdLinea" id="IdLinea" class="Textbox " size="1" onChange="updateLineaMenu('IdLinea','IdSentido','IdJornada','IdParadaOr','BotonBuscar3','es');">
				    		<option value="0"  selected >Escoge una linia</option>
				    	
					   		<option value="1-2"  title="EL PINAR-CAN SERRAFOSSÀ"> L1. Can Serrafossà-El Pinar</option>
				    	
					   		<option value="1-1"  title="EL PINAR-CAN SERRAFOSSÀ"> L1. El Pinar-Can Serrafossà</option>
				    	
					   		<option value="2-4"  title="CAN VALLHONRAT-EL PINAR"> L2. El Pinar/Can Rosés-Can Vallhonrat</option>
				    	
					   		<option value="2-3"  title="CAN VALLHONRAT-EL PINAR"> L2. Can Vallhonrat-El Pinar/Can Rosés</option>
				    	
					   		<option value="3-14"  title="ESTACIÓ RUBÍ+D-CASTELLNOU"> L3. Estació RubÍ+D-Castellnou</option>
				    	
					   		<option value="3-13"  title="ESTACIÓ RUBÍ+D-CASTELLNOU"> L3. Castellnou-Estació RubÍ+D</option>
				    	
					   		<option value="4-6"  title="ESTACIÓ RUBÍ+D-CAN ROSÉS"> L4. Can Rosés-Estació RubÍ+D</option>
				    	
					   		<option value="4-5"  title="ESTACIÓ RUBÍ+D-CAN ROSÉS"> L4. Estació RubÍ+D-Can Rosés</option>
				    	
					   		<option value="5-8"  title="CAN ROSÉS-ESTACIÓ RUBÍ+D"> L5. Estació RubÍ+D-Can Rosés</option>
				    	
					   		<option value="5-7"  title="CAN ROSÉS-ESTACIÓ RUBÍ+D"> L5. Can Rosés-Estació RubÍ+D</option>
				    	
					   		<option value="6-12"  title="RUBÍ SUD-POL. LA BASTIDA"> L6. Pol. La Bastida-Pol. Rubí Sud</option>
				    	
					   		<option value="6-9"  title="RUBÍ SUD-POL. LA BASTIDA"> L6. Pol. Rubí Sud-Pol. La Bastida</option>
				    	
					   		<option value="7-16"  title="ESTACIÓ RUBÍ+D-SANT MUÇ"> L7. Sant Muç-Estació RubÍ+D</option>
				    	
					   		<option value="7-15"  title="ESTACIÓ RUBÍ+D-SANT MUÇ"> L7. Estació RubÍ+D-Sant Muç</option>
				    	
							</select>
						</div>
					</div>
					<div class="div-table-row">
						<div class="div-table-col primero">Parada origen</div>
						<div class="div-table-col">
							<select name="IdParadaOr" id="IdParadaOr" class="Textbox InputW213" size="1" onChange="paradaSeleccionada2Origen('IdLinea','IdSentido','IdJornada','IdParadaDe','BotonBuscar3','es');">
								
										<option value="0"  selected >Escoge una parada origen</option>
								
							</select>
						</div>
					</div>
					<div class="div-table-row">
						<div class="div-table-col">Parada destino</div>
						<div class="div-table-col">
							<select name="IdParadaDe" id="IdParadaDe" class="Textbox InputW213" size="1" onChange="paradaSeleccionada2('IdLinea','IdSentido','IdJornada','IdParadaDe','BotonBuscar3','es');">
								
										<option value="0"  selected >Escoge una parada dest&iacute;</option>
								
							</select>
						</div>
					</div>
					<div class="div-table-row">
						<div class="div-table-col">Jornada</div>
						<div class="div-table-col">
							<select name="IdJornada" id="IdJornada" class="Textbox InputW213" size="1" onChange="updateJornadaMenu2('IdLinea','IdSentido','IdJornada','IdParadaOr','BotonBuscar3');">
		        			<option value="0" selected>Escoge una jornada</option>
							</select>
						</div>
					</div>
				</div>
			</div> 
			<div class="clear"></div>
		</div>
		
		
		<div id="taulaTemps" style="display:none;">
			<table width="515px" border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td width="171px">
						Parada origen
					</td>
					<td width="171px">
						Parada destino
					</td>
					<td width="171px">
						Tiempo del recorrido
					</td>
				</tr>
				<tr>
					<td id="txtPOr">
						
					</td>
					<td id="txtPDe">
						
					</td>
					<td>
						
					</td>
				</tr>
				<tr>
					<td>
						
					</td>
					<td>
						
					</td>
					<td>
						
					</td>
				</tr>
			</table>
		</div>
		<div id="ErrortaulaTemps" style="display:none;">
		No hay un trayecto entre estas paradas en esta jornada
		</div>
		
	</div>
	

						<div class="clear"></div>
					</div>
					


<div id="fila3" >


<!-- START RUBIBUS REAL TIME SCHEDULE :: http://laravel.javajan.com/rubibus-soap/public -->
<style>
    #rbeContainer{float:left;background-image:url(https://rubibus.com/imagenes/Home/cuandollegara.png);background-repeat:no-repeat;background-position:50%;height:138px;text-align:left;font-family:arial;font-size:10px;width:330px;padding:0;background-size:cover;color:#000!important}#rbeContainer h3{margin:15px 0;font-size:14px;font-weight:700!important}#rbeContainer label{font-weight:700;display:block;margin:10px 0}#rbeContainer button{border-radius:4px;font-size:12px;font-weight:700;color:#fff;background:#1c73ad;padding:7.5px 17.5px;box-shadow:0 0 0 2px hsla(0,0%,63%,.5);border:none;text-decoration:none}#rbeContainer button:hover{color:#fff;background:#1c73ff;cursor:pointer}#rbeContainer button:focus{outline:none}#rbeContainer button#backBtn,#rbeContainer button#goBtn{font-size:10px;padding:5px 10px;margin-left:15px}#rbeWrapper{text-align:left;margin-right:25px;margin-left:25px;height:100%;position:relative;overflow:auto;overflow-x:hidden;overflow-y:auto}#resultWrapper .vehicle{width:280px;max-width:280px;font-weight:700;height:15px;margin-bottom:3.5px;overflow:hidden}#resultWrapper .vehicle:nth-child(even){background-color:hsla(0,0%,100%,.65)}#resultWrapper .vehicle img{float:left}#resultWrapper .vehicle .direction{max-width:165px;width:165px;overflow:hidden;float:left;padding-top:2.5px}#resultWrapper .vehicle .distance{width:45px;max-width:45px;color:#666;margin-left:5px;float:left;padding-top:2.5px}#resultWrapper .vehicle .arrival{text-align:right;width:50px;max-width:50px;float:left;padding-top:2.5px}.rbeStep{height:100%;position:absolute;top:0;left:0;width:100%}.rbeStep.on{opacity:1;z-index:999}.rbeStep.off{opacity:0;z-index:-1}#rbeStep1{text-align:center;padding-top:0;height:100px}#refreshBtnWrapper{text-align:center;margin-top:15px}#refreshBtnWrapper button{margin:0 15px}@keyframes loading{0%{opacity:0;width:30px;height:30px;margin-left:-15px;bottom:10px}50%{opacity:1;width:40px;height:40px;margin-left:-20px;bottom:5px}to{opacity:0;width:30px;height:30px;margin-left:-15px;bottom:10px}}#rbeStatus{width:30px;height:30px;border-radius:20px;background-color:#e60000;position:absolute;bottom:10px;left:50%;margin-left:-15px;animation:loading 1s infinite;display:none}#rbeStatus.on{display:block}@media (min-width:1030px){#rbeContainer{width:400px;height:151px;padding:15px 17px}#rbeWrapper{margin-right:60px;margin-left:60px}}</style>
<div id="rbeContainer" data-request-url="http://laravel.javajan.com/rubibus-soap/public">
    <div id="rbeWrapper">
        <div id="rbeStep1" class="rbeStep on">
            <h3>¿Quieres saber en tiempo real cuánto <br> tardará tu bus?</h3>
            <div id="checkBtnWrapper"></div>
        </div>
        <div id="rbeStep2" class="rbeStep off">
             <div id="selectLineWrapper">
                <label>Linea</label>
            </div>
            <div id="selectStopWrapper">
                <label>Parada</label>
            </div>
        </div>
        <div id="rbeStep3" class="rbeStep off">
            <div id="resultWrapper">
            </div>
            <div id="refreshBtnWrapper">
            </div>
        </div>
        <div id="rbeStatus"></div>
    </div>
</div>
<script type="text/javascript">
	if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
		$("#fila3").insertAfter("#LineasGeneral");
	}
</script>

<!-- END RUBIBUS REAL TIME SCHEDULE -->


	<a href="https://rubibus.com/index.asp?seccion=calculoRecorrido&lang=es" title="Ir a Calculo Recorrido" class="muestraTitle">
	<div id="CalculoCuandoLlegara">
		<span class="normal negrita sombraVertical">Calcular el tiempo <br>que tardará el bus <br> en hacer un recorrido <br> entero</span>
	</div>
	</a>
</div>
<script type="text/javascript">
    var searchInArrayOfObjects=function(e,t,n){for(var o=0;o<n.length;o++)if(n[o][e]===t)return n[o]},cleanSelector=function(e,t){$(" :not("+t+")",e).remove()};rbe={box:"#rbeContainer",selectedLine:null,selectedDirection:null,selectedDirectionStop:null,lineDirections:null,lineDirectionsStops:null,linesResponse:null,stopResponse:null,requestUrl:null,init:function(){$(rbe.box).length<=0,rbe.requestUrl=$(rbe.box).data("requestUrl"),$startButton=$("<button/>",{id:"checkBtn"}).text("Consultar líneas").appendTo("#checkBtnWrapper"),$selectLine=$("<select/>",{id:"lineSelector",disabled:"diabled"}).appendTo("#selectLineWrapper"),$selectStop=$("<select/>",{id:"stopSelector",disabled:"disabled"}).appendTo("#selectStopWrapper"),$backButton=$("<button/>",{id:"backBtn"}).text("Volver").appendTo("#refreshBtnWrapper"),$goButton=$("<button/>",{id:"goBtn"}).text("Ver buses").appendTo("#selectStopWrapper"),$("<option />",{value:"null",text:"Selecciona una línea","class":"label"}).appendTo($selectLine),$("<option />",{value:"null",text:"Selecciona una parada","class":"label"}).appendTo($selectStop),$startButton.on("click",function(){rbe.getLines(),cleanSelector($selectLine,".label"),$(this).prop("disabled",!0),$("#rbeStatus").toggleClass("on");var e=setInterval(function(){rbe.status&&(clearInterval(e),rbe.setLines($selectLine))},1)}),$backButton.on("click",function(){$(rbe.box+" .vehicle").remove(),$("#rbeStep2").toggleClass("on off"),$("#rbeStep3").toggleClass("on off")}),$selectLine.on("change",function(){$(rbe.box+" .vehicle").remove(),rbe.selectedLine=parseInt($(this).val()),cleanSelector($selectStop,".label"),"null"!=rbe.selectedLine&&rbe.setLineStops(rbe.selectedLine,$selectStop)}),$goButton.on("click",function(){$(rbe.box+" .vehicle").remove(),$(this).prop("disabled",!0),$("#rbeStatus").toggleClass("on"),rbe.selectedDirectionStop=$($selectStop).val(),rbe.getStopMonitor(rbe.selectedDirectionStop)})},getLines:function(){$.getJSON(rbe.requestUrl+"/lines",function(e){rbe.linesResponse=e}).done(function(){rbe.status=!0,$("#rbeStep1").toggleClass("on off"),$("#rbeStep2").toggleClass("on off")}).fail(function(){alert("La consulta de líneas no se ha realizado.")}).always(function(){$("#checkBtn").prop("disabled",!1),$("#rbeStatus").toggleClass("on")})},getLineStops:function(e){return searchInArrayOfObjects("lineRef",e,rbe.linesResponse).lineStops},getStopMonitor:function(e){null!=e||"null"!=e?$.getJSON(rbe.requestUrl+"/stops/show/"+e,function(e){rbe.stopResponse=e,$.each(e,function(e,t){t.Answer.StopMonitoringDelivery.hasOwnProperty("MonitoredStopVisit")&&rbe.setStopVisits(t.Answer.StopMonitoringDelivery.MonitoredStopVisit)})}).done(function(){$("#rbeStep2").toggleClass("on off"),$("#rbeStep3").toggleClass("on off")}).fail(function(){alert("La consulta de parades no se ha realizado.")}).always(function(){$("#goBtn").prop("disabled",!1),$("#rbeStatus").toggleClass("on")}):alert("Selecciona una línea y una parada.")},setLines:function(e){e.prop("disabled",!1),$.each(rbe.linesResponse,function(t,n){$("<option />",{value:n.lineRef,text:"L"+n.lineRef+" - "+n.lineName}).appendTo(e)})},setLineStops:function(e,t){t.prop("disabled",!1),rbe.lineDirectionsStops=rbe.getLineStops(e),stops=[],$.each(rbe.lineDirectionsStops,function(e,n){stops.push(e),$("<option />",{value:n,text:e}).appendTo(t)}),stops.sort()},setStopVisits:function(e){$.isArray(e)||(e=[e]),$.each(e,function(e,t){image='<img src="http://rubibus.com/DOCUMENTS/Menu/Linies/l'+t.MonitoredVehicleJourney.LineRef+'no.png" width="15px">',vehicleRef=t.MonitoredVehicleJourney.VehicleRef,lineDirection="L"+t.MonitoredVehicleJourney.LineRef+" "+t.MonitoredVehicleJourney.DirectionName,vehicleArrival=t.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime,vehicleDistance=t.MonitoredVehicleJourney.MonitoredCall.DistanceFromStop,date1=new Date(vehicleArrival),date2=new Date,timeDiff=Math.abs(date2.getTime()-date1.getTime()),diffMins=Math.round(timeDiff/6e4),vehicle='<div class="vehicle">',vehicle+=image,vehicle+='<span class="direction">',vehicle+="&nbsp;"+t.MonitoredVehicleJourney.DirectionName,vehicle+="</span>",vehicle+='<span class="arrival">',vehicle+=diffMins+" mins",vehicle+="</span>",vehicle+='<span class="distance">',vehicle+=Math.round(parseInt(vehicleDistance)/1e3*100)/100,vehicle+=" km</span>",vehicle+="</div>",$(vehicle).appendTo(rbe.box+" #resultWrapper")})}},document.addEventListener("DOMContentLoaded",function(){if("function"!=typeof jQuery){var e=document.createElement("script");e.setAttribute("src","http://code.jquery.com/jquery-1.8.0.js"),e.setAttribute("type","text/javascript"),document.body.appendChild(e)}var t=setInterval(function(){"function"==typeof jQuery&&(clearInterval(t),rbe.init())},1)});</script>


		<div class="clear"></div>
	</div>
	
		<div class="clear"></div>
		
	<div id="Pie">
		<div id="FilaPie">
			<div id="BloqueMenu">
				<div class="columna">
					<h1>SERVICIOS A <br> VIAJEROS</h1>
					<div class="listadoMenu">
						<ul>
							<li><a href="https://rubibus.com/index.asp?seccion=textos&subsec=30&lang=es" title="Ir a Consejos de viaje" class="muestraTitle">Consejos de viaje</a></li>
							<li><a href="https://rubibus.com/index.asp?seccion=conexiones&lang=es" title="Ir a Conexiones con otros municipios" class="muestraTitle">Conexiones con otros municipios</a></li>
							<li><a href="https://rubibus.com/index.asp?seccion=textosReducido&subsec=14&lang=es" title="Ir a Objetos Perdidos" class="muestraTitle"> Objetos Perdidos</a></li>
							<li><a href="DOCUMENTS/RUBIBUS_Reglament.pdf"  target="new" title="Ir a Reglamento" class="muestraTitle">Reglamento</a></li>
						</ul>
					</div>
				</div>
				<div class="columna">
					<h1>INFORMACIÓN<BR>CORPORATIVA</h1>
					<div class="listadoMenu">
						<ul>
							<li><a href="https://rubibus.com/index.asp?seccion=textosReducido&subsec=23&lang=es" title="Ir a Presentación de la empresa" class="muestraTitle">Presentación de la empresa</a></li>
							<li><a href="https://rubibus.com/index.asp?seccion=textosReducido&subsec=24&lang=es" title="Ir a Enlaces de interés" class="muestraTitle">Enlaces de interés</a></li>
						</ul>
					</div>
				</div>
				<div class="columnafinal">
					<h1>CONTACTAR</h1>
					<div class="listadoMenu">
						<ul>
							<li><a href="https://rubibus.com/index.asp?seccion=textosReducido&subsec=15&lang=es" title="Ir a Sugerencias / Reclamaciones" class="muestraTitle">Sugerencias / Reclamaciones</a></li>
							<li><a href="https://rubibus.com/index.asp?seccion=textosReducido&subsec=7&lang=es" title="Ir a Trabaja con nosotros" class="muestraTitle">Trabaja con nosotros</a></li>
						</ul>
					</div>
				</div>
			</div>
			<div id="BloqueBanners">
				<div class="banner" style="margin-right: 11px;margin-top: 16px;position: relative;">
					<img src="imagenes/Footer/logo_avanza_ajuntament_rubi.png"  title="">
				</div>
				
			</div>
		</div>
		<div class="clear"></div>
		<div id="Fila2Pie">
			<ul>
				<li>&#169;&nbsp;2016 - Todos los derechos reservados</li>
			</ul>
			<ul class="derecha">
				<li><a href="https://avanzagrupo.com/wp-content/uploads/2020/09/C%C3%B3digo-de-%C3%89tica-y-Conducta-Mobility-ADO_compressed.pdf" title="Ir a Código de Ética y Conducta" target="_blank">Código de Ética y Conducta</a></li>
				<li>|</li>
				<li><a href="https://avanzagrupo.com/wp-content/uploads/2020/09/Formulario-de-comunicaci%C3%B3n-del-Canal-%C3%89tico-OK.docx" title="Ir a Formulario de Comunicación del Canal Ético">Formulario de Comunicación del Canal Ético</a></li>
				<li>|</li>
				<li><a href="https://avanzagrupo.com/wp-content/uploads/2020/09/Reglamento-del-Canal-%C3%89tico.pdf" target="_blank" title="Ir a Reglamento del Canal Ético">Reglamento del Canal Ético</a></li>
				<li>|</li>
				<li><a href="https://rubibus.com/index.asp?seccion=textosReducido&subsec=11&lang=es" title="Ir a Aviso Legal" class="muestraTitle">Aviso Legal</a></li>
				<li>|</li>
				<li><a href="https://rubibus.com/index.asp?seccion=mapaweb&lang=es" title="Ir a Mapa Web" class="muestraTitle">Mapa Web</a></li>
			</ul>
			<div class="clear"></div>
		</div>
	</div>

	
	<div id="banner" class="modal">
		<div id="modal-content" class="modal-content" style="max-width:480px;">
			<span id="close" class="close">&times;</span>
			<a href="https://rubibus.com/DOCUMENTS/horaris_estiu_2020.pdf" target="_blank">
				<img class="img-banner" src="https://rubibus.com/IMAGES/consulta-horari-aqui.jpg" alt="horaris estiu 2020">
			</a>			
		</div>
	</div>
</div>



<a id="msie7" rel="lyteframe" href="msie7.html" title="ActualizaciÃ³n necesaria"></a>
<script type="text/javascript" src="/map_areas.responsive.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40324757-1', 'rubibus.com');
  ga('send', 'pageview');

</script>
<script>
	 // Get the modal
	 var modal = document.getElementById('banner');
	 

	 // Get the <span> element that closes the modal
	 var span = document.getElementsByClassName("close")[0];

	 modal.onclick = function(e) {
		
	 	if (document.getElementById('close').contains(e.target)){
     		// close button
	 		modal.style.display = "none";
	 	}else if(document.getElementById('modal-content').contains(e.target)){
	 		// Clicked inside the box do nothing
	 	}else{
	 		// Clicked outside the box
	 		modal.style.display = "none";
	 	}
	 }
</script>
</body>

</html>
